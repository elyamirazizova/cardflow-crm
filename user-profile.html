<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CardFlow - –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="api.js"></script>
    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <style>
        .timeline {
            position: relative;
            padding-left: 2rem;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e5e7eb;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2rem;
            top: 0.25rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #7400bc;
            border: 2px solid white;
        }
        .skill-bar {
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
        }
        .skill-progress {
            height: 8px;
            background: linear-gradient(90deg, #7400bc, #9b59d7);
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        .stage-badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-weight: 500;
        }
        .project-card {
            transition: all 0.2s ease;
            border-left: 4px solid;
        }
        .project-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-white">
    <custom-navbar></custom-navbar>

    <div class="container mx-auto px-4 py-8">
        <div class="flex items-center gap-4 mb-6">
            <button onclick="window.history.back()" class="bg-gray-100 hover:bg-gray-200 p-2 rounded-lg transition">
                <i data-feather="arrow-left" class="w-5 h-5"></i>
            </button>
            <h1 class="text-3xl font-bold">–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h1>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="lg:col-span-1">
                <div class="bg-white p-6 rounded-lg shadow sticky top-8">
                    <div class="flex flex-col items-center mb-6">
                        <div class="w-32 h-32 rounded-full bg-purple-100 flex items-center justify-center mb-4">
                            <i data-feather="user" class="w-16 h-16 text-purple-600"></i>
                        </div>
                        <h2 id="userName" class="text-xl font-semibold text-center">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
                        <p id="userRole" class="text-gray-500 text-center">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        <p id="userPosition" class="text-gray-600 text-center mt-1">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        <div id="userStatus" class="mt-2"></div>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 mb-1 flex items-center gap-2">
                                <i data-feather="mail" class="w-4 h-4"></i>
                                Email
                            </h3>
                            <p id="userEmail" class="text-gray-700">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 mb-1 flex items-center gap-2">
                                <i data-feather="phone" class="w-4 h-4"></i>
                                –¢–µ–ª–µ—Ñ–æ–Ω
                            </h3>
                            <p id="userPhone" class="text-gray-700">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 mb-1 flex items-center gap-2">
                                <i data-feather="calendar" class="w-4 h-4"></i>
                                –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                            </h3>
                            <p id="userCreatedAt" class="text-gray-700">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 mb-1 flex items-center gap-2">
                                <i data-feather="briefcase" class="w-4 h-4"></i>
                                –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã
                            </h3>
                            <p id="userExperience" class="text-gray-700">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-gray-500 mb-1 flex items-center gap-2">
                                <i data-feather="award" class="w-4 h-4"></i>
                                –£—Ä–æ–≤–µ–Ω—å
                            </h3>
                            <p id="userLevel" class="text-gray-700">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                    </div>

                    <!-- –ù–∞–≤—ã–∫–∏ -->
                    <div class="mt-6">
                        <h3 class="text-sm font-medium text-gray-500 mb-3 flex items-center gap-2">
                            <i data-feather="zap" class="w-4 h-4"></i>
                            –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏
                        </h3>
                        <div id="userSkills" class="space-y-2">
                            <!-- –ù–∞–≤—ã–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="lg:col-span-3 space-y-8">
                <!-- –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold flex items-center gap-2">
                            <i data-feather="clock" class="text-orange-600"></i>
                            –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
                        </h2>
                        <div class="text-sm text-gray-500">
                            –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤: <span id="activeProjectsCount">0</span>
                        </div>
                    </div>
                    
                    <div id="activeProjects" class="space-y-4">
                        <p class="text-gray-500">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –Ω–∞–≥—Ä–∞–¥—ã -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-feather="award" class="text-purple-600"></i>
                        –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –Ω–∞–≥—Ä–∞–¥—ã
                    </h2>
                    <div id="userAchievements" class="prose max-w-none">
                        <p class="text-gray-500">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <!-- –ö–∞—Ä—å–µ—Ä–∞ –∏ –æ–ø—ã—Ç -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-feather="trending-up" class="text-purple-600"></i>
                        –ö–∞—Ä—å–µ—Ä–Ω—ã–π –ø—É—Ç—å
                    </h2>
                    <div id="userCareer" class="timeline">
                        <!-- –¢–∞–π–º–ª–∞–π–Ω –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>

                <!-- –ü—Ä–æ–µ–∫—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold flex items-center gap-2">
                            <i data-feather="folder" class="text-purple-600"></i>
                            –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                        </h2>
                        <div class="text-sm text-gray-500">
                            –í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: <span id="totalProjectsCount">0</span>
                        </div>
                    </div>
                    
                    <div id="userProjects" class="space-y-4">
                        <p class="text-gray-500">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-feather="bar-chart-2" class="text-purple-600"></i>
                        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    </h2>
                    <div id="userStats" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <custom-footer></custom-footer>

    <script>
        let currentUser = null;
        let allProjects = [];

        // –î–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
        const userDetails = {
            1: {
                experience: "8 –ª–µ—Ç –≤ IT-–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥–µ",
                level: "–°—Ç–∞—Ä—à–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç",
                skills: [
                    { name: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏", level: 95 },
                    { name: "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã", level: 90 },
                    { name: "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞", level: 85 },
                    { name: "–§–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", level: 88 }
                ],
                career: [
                    { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂", company: "CardFlow", description: "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ç–¥–µ–ª–æ–º –∏–∑ 15 —á–µ–ª–æ–≤–µ–∫. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –Ω–∞ 45%." },
                    { year: "2020-2023", position: "–°—Ç–∞—Ä—à–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä", company: "–ò–¢-–ö–æ–Ω—Å–∞–ª—Ç", description: "–†–∞–±–æ—Ç–∞ —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏. –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–æ–∫ –æ—Ç 5 –º–ª–Ω —Ä—É–±." },
                    { year: "2017-2020", position: "–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤", company: "–¢–µ—Ö–Ω–æ–°–∏—Å—Ç–µ–º—ã", description: "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ CRM —Å–∏—Å—Ç–µ–º –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞." },
                    { year: "2015-2017", position: "–î–∂—É–Ω–∏–æ—Ä –º–µ–Ω–µ–¥–∂–µ—Ä", company: "–°–æ—Ñ—Ç–°–µ—Ä–≤–∏—Å", description: "–û–±—É—á–µ–Ω–∏–µ –∏ –ø–µ—Ä–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–¥ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞." }
                ],
                achievements: "üèÜ –õ—É—á—à–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä 2023 –≥–æ–¥–∞\nüåü –£–≤–µ–ª–∏—á–∏–ª –≤—ã—Ä—É—á–∫—É –æ—Ç–¥–µ–ª–∞ –Ω–∞ 45%\nüíº –ü—Ä–∏–≤–ª–µ–∫ 12 –Ω–æ–≤—ã—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤\nüéØ –ü–µ—Ä–µ–≤—ã–ø–æ–ª–Ω–∏–ª –ø–ª–∞–Ω –ø—Ä–æ–¥–∞–∂ –Ω–∞ 67%\nüìà –£–≤–µ–ª–∏—á–∏–ª —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –Ω–∞ 28%\nü§ù –ó–∞–∫—Ä—ã–ª —Å–∞–º—É—é –∫—Ä—É–ø–Ω—É—é —Å–¥–µ–ª–∫—É –∫–æ–º–ø–∞–Ω–∏–∏ - 28 –º–ª–Ω —Ä—É–±.",
                stats: {
                    totalRevenue: "156,800,000 ‚ÇΩ",
                    completedProjects: 47,
                    successRate: "94%",
                    clientSatisfaction: "4.8/5"
                }
            },
            2: {
                experience: "6 –ª–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏",
                level: "–≠–∫—Å–ø–µ—Ä—Ç",
                skills: [
                    { name: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º", level: 92 },
                    { name: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", level: 88 },
                    { name: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è", level: 85 },
                    { name: "–û–±—É—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞", level: 80 }
                ],
                career: [
                    { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã", company: "CardFlow", description: "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CRM —Å–∏—Å—Ç–µ–º—ã. –û–±—É—á–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤." },
                    { year: "2021-2023", position: "–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä", company: "–î–∞–Ω–Ω—ã–µ –∏ –†–µ—à–µ–Ω–∏—è", description: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã." },
                    { year: "2019-2021", position: "–ò–¢-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç", company: "–¢–µ—Ö–Ω–æ–ü–∞—Ä–∫", description: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è." },
                    { year: "2017-2019", position: "–°—Ç–∞–∂–µ—Ä", company: "–ò–¢-–ê–∫–∞–¥–µ–º–∏—è", description: "–û–±—É—á–µ–Ω–∏–µ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—é." }
                ],
                achievements: "üîí –í–Ω–µ–¥—Ä–∏–ª–∞ —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞\nüìä –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–ª–∞ 15 –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤\nüéì –û–±—É—á–∏–ª–∞ 45+ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Ä–∞–±–æ—Ç–µ —Å —Å–∏—Å—Ç–µ–º–æ–π\n‚è±Ô∏è –°–æ–∫—Ä–∞—Ç–∏–ª–∞ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫ –Ω–∞ 40%\nüõ°Ô∏è –í–Ω–µ–¥—Ä–∏–ª–∞ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é\nüìà –ü–æ–≤—ã—Å–∏–ª–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –¥–æ 99.9%",
                stats: {
                    totalRevenue: "28,500,000 ‚ÇΩ",
                    completedProjects: 23,
                    successRate: "98%",
                    clientSatisfaction: "4.9/5"
                }
            },
            3: {
                experience: "7 –ª–µ—Ç –≤ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–µ",
                level: "–í–µ–¥—É—â–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫",
                skills: [
                    { name: "–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö", level: 95 },
                    { name: "SQL", level: 90 },
                    { name: "Tableau/Power BI", level: 88 },
                    { name: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", level: 85 }
                ],
                career: [
                    { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–°—Ç–∞—Ä—à–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫", company: "CardFlow", description: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—à–±–æ—Ä–¥–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤." },
                    { year: "2020-2023", position: "–ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫", company: "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ü—Ä–æ", description: "–ê–Ω–∞–ª–∏–∑ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤." },
                    { year: "2018-2020", position: "–ê–Ω–∞–ª–∏—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö", company: "–°—Ç–∞—Ç–†–µ—à–µ–Ω–∏—è", description: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤." },
                    { year: "2016-2018", position: "–ú–ª–∞–¥—à–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫", company: "–î–∞–Ω–Ω—ã–µ+", description: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π." }
                ],
                achievements: "üìä –†–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∞ 5 —É—Å–ø–µ—à–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤\nüîç –í—ã—è–≤–∏–ª–∞ 3 –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ —Ä–æ—Å—Ç–∞ –±–∏–∑–Ω–µ—Å–∞\nüìà –£–≤–µ–ª–∏—á–∏–ª–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞ 35%\nüí° –í–Ω–µ–¥—Ä–∏–ª–∞ ML-–º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è\nüéØ –°–Ω–∏–∑–∏–ª–∞ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –Ω–∞ 25%\nüèÜ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –∫–æ–Ω–∫—É—Ä—Å–∞ '–õ—É—á—à–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫ 2022'",
                stats: {
                    totalRevenue: "42,300,000 ‚ÇΩ",
                    completedProjects: 31,
                    successRate: "96%",
                    clientSatisfaction: "4.7/5"
                }
            },
            5: {
                experience: "5 –ª–µ—Ç –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏",
                level: "–°—Ç–∞—Ä—à–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç",
                skills: [
                    { name: "Agile/Scrum", level: 88 },
                    { name: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏", level: 85 },
                    { name: "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞", level: 90 },
                    { name: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è", level: 82 }
                ],
                career: [
                    { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤", company: "CardFlow", description: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ IT-–ø—Ä–æ–µ–∫—Ç–∞–º–∏ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤." },
                    { year: "2021-2023", position: "Project Manager", company: "DevTeam Pro", description: "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∫–æ–º–∞–Ω–¥–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–æ 8 —á–µ–ª–æ–≤–µ–∫." },
                    { year: "2019-2021", position: "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤", company: "–¢–µ—Ö–Ω–æ–°—Ç–∞—Ä—Ç", description: "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏." },
                    { year: "2018-2019", position: "–°—Ç–∞–∂–µ—Ä PM", company: "IT Solutions", description: "–ò–∑—É—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏." }
                ],
                achievements: "‚úÖ –ó–∞–≤–µ—Ä—à–∏–ª 10 –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º KPI\nüöÄ –°–æ–∫—Ä–∞—Ç–∏–ª —Å—Ä–æ–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ 15%\nüí¨ –£–ª—É—á—à–∏–ª –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏\nüìä –í–Ω–µ–¥—Ä–∏–ª —Å–∏—Å—Ç–µ–º—É –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤\nüéØ –î–æ—Å—Ç–∏–≥ 98% —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤\n‚≠ê –ü–æ–ª—É—á–∏–ª 12 –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤",
                stats: {
                    totalRevenue: "78,200,000 ‚ÇΩ",
                    completedProjects: 28,
                    successRate: "95%",
                    clientSatisfaction: "4.8/5"
                }
            },
            19: {
                experience: "12 –ª–µ—Ç –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂–∞—Ö",
                level: "–≠–∫—Å–ø–µ—Ä—Ç",
                skills: [
                    { name: "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–¥–∞–∂–∏", level: 96 },
                    { name: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π", level: 92 },
                    { name: "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã", level: 94 },
                    { name: "–ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞", level: 88 }
                ],
                career: [
                    { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–°—Ç–∞—Ä—à–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä", company: "CardFlow", description: "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ç–¥–µ–ª–æ–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂." },
                    { year: "2018-2023", position: "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞", company: "–ë–∏–∑–Ω–µ—Å–†–µ—à–µ–Ω–∏—è", description: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–æ–º –∏–∑ 12 –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤." },
                    { year: "2014-2018", position: "–ö–ª—é—á–µ–≤–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä", company: "–ö–æ—Ä–ø–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", description: "–†–∞–±–æ—Ç–∞ —Å –∫—Ä—É–ø–Ω—ã–º–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏." },
                    { year: "2011-2014", position: "–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º", company: "–ò–¢-–ü–∞—Ä—Ç–Ω–µ—Ä", description: "–ù–∞—á–∞–ª–æ –∫–∞—Ä—å–µ—Ä—ã –≤ IT-–ø—Ä–æ–¥–∞–∂–∞—Ö." }
                ],
                achievements: "üè¢ –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂\nüí∞ –ü—Ä–∏–≤–ª–µ–∫ 45+ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤\nüìà –£–≤–µ–ª–∏—á–∏–ª –≥–æ–¥–æ–≤–æ–π –æ–±–æ—Ä–æ—Ç –Ω–∞ 120%\nüéØ –ó–∞–∫—Ä—ã–ª 3 —Å–¥–µ–ª–∫–∏ > 50 –º–ª–Ω —Ä—É–±.\nüåü –í—ã—Ä–∞—Å—Ç–∏–ª 5 –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –¥–æ —Å—Ç–∞—Ä—à–∏—Ö –ø–æ–∑–∏—Ü–∏–π\nüèÜ –õ—É—á—à–∏–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ 2022",
                stats: {
                    totalRevenue: "245,600,000 ‚ÇΩ",
                    completedProjects: 67,
                    successRate: "97%",
                    clientSatisfaction: "4.9/5"
                }
            },
            23: {
                experience: "20+ –ª–µ—Ç –≤ –ò–¢-–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥–µ",
                level: "–ì—É—Ä—É",
                skills: [
                    { name: "–ò–¢-–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥", level: 98 },
                    { name: "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", level: 95 },
                    { name: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏–π", level: 92 },
                    { name: "–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ", level: 90 }
                ],
                career: [
                    { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–í–µ–¥—É—â–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä", company: "CardFlow", description: "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤." },
                    { year: "2015-2023", position: "–ü–∞—Ä—Ç–Ω–µ—Ä", company: "–ö–æ–Ω—Å–∞–ª—Ç–ì—Ä—É–ø–ø", description: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ò–¢-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–ª—è –∫—Ä—É–ø–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞." },
                    { year: "2008-2015", position: "–°—Ç–∞—Ä—à–∏–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç", company: "Deloitte", description: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏." },
                    { year: "2003-2008", position: "–ò–¢-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä", company: "IBM", description: "–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º." },
                    { year: "2000-2003", position: "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫", company: "Microsoft", description: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–∏–∑–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π." }
                ],
                achievements: "üéì 20+ –ª–µ—Ç –æ–ø—ã—Ç–∞ –≤ –ò–¢-–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥–µ\nüèõÔ∏è –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–ª 50+ –∫–æ–º–ø–∞–Ω–∏–π –∏–∑ Fortune 500\nüìö –ê–≤—Ç–æ—Ä 3 –∫–Ω–∏–≥ –ø–æ —Ü–∏—Ñ—Ä–æ–≤–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏\nüé§ –†–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–ø–∏–∫–µ—Ä –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è—Ö\nüåü –ú–µ–Ω—Ç–æ—Ä –¥–ª—è 30+ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π\nüí° –†–∞–∑—Ä–∞–±–æ—Ç–∞–ª 15 —É—Å–ø–µ—à–Ω—ã—Ö –ò–¢-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π",
                stats: {
                    totalRevenue: "189,400,000 ‚ÇΩ",
                    completedProjects: 89,
                    successRate: "99%",
                    clientSatisfaction: "5.0/5"
                }
            }
        };

        // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–∑–¥–∞–º –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        for (let i = 4; i <= 23; i++) {
            if (!userDetails[i]) {
                userDetails[i] = {
                    experience: `${Math.floor(Math.random() * 10) + 3} –ª–µ—Ç –≤ ${['IT', '–ø—Ä–æ–¥–∞–∂–∞—Ö', '–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–µ', '–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥–µ'][i % 4]}`,
                    level: ['–î–∂—É–Ω–∏–æ—Ä', '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', '–°—Ç–∞—Ä—à–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', '–≠–∫—Å–ø–µ—Ä—Ç'][i % 4],
                    skills: [
                        { name: "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è", level: 70 + (i * 3) % 25 },
                        { name: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", level: 65 + (i * 5) % 30 },
                        { name: "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞", level: 60 + (i * 7) % 35 },
                        { name: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏", level: 75 + (i * 2) % 20 }
                    ],
                    career: [
                        { year: "2023-–Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è", position: "–ú–µ–Ω–µ–¥–∂–µ—Ä", company: "CardFlow", description: "–†–∞–±–æ—Ç–∞ –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∫–æ–º–ø–∞–Ω–∏–∏." },
                        { year: "2021-2023", position: "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç", company: "–ü—Ä–µ–¥—ã–¥—É—â–∞—è –∫–æ–º–ø–∞–Ω–∏—è", description: "–†–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤." },
                        { year: "2019-2021", position: "–ù–∞—á–∏–Ω–∞—é—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç", company: "–ü–µ—Ä–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è", description: "–°—Ç–∞—Ä—Ç –∫–∞—Ä—å–µ—Ä—ã –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏." }
                    ],
                    achievements: "‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤\nüéØ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö KPI\nüíº –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏\nüìà –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç\nü§ù –ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞\n‚≠ê –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã",
                    stats: {
                        totalRevenue: `${(15 + (i * 3))},${(i * 100)}0,000 ‚ÇΩ`,
                        completedProjects: 10 + (i % 15),
                        successRate: `${85 + (i % 12)}%`,
                        clientSatisfaction: `${4 + (i % 10) / 10}.${i % 10}/5`
                    }
                };
            }
        }

        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage
                const userData = localStorage.getItem('viewing_user_profile');
                if (userData) {
                    currentUser = JSON.parse(userData);
                    console.log('–¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', currentUser);
                    displayUserInfo(currentUser);
                    displayUserDetails(currentUser);
                } else {
                    showErrorPage();
                    return;
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–µ–∫—Ç—ã
                try {
                    allProjects = await api.getProjects();
                    console.log('–ü—Ä–æ–µ–∫—Ç—ã –∏–∑ API:', allProjects.length);
                } catch (error) {
                    console.log('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage');
                    allProjects = JSON.parse(localStorage.getItem('projects') || '[]');
                    console.log('–ü—Ä–æ–µ–∫—Ç—ã –∏–∑ localStorage:', allProjects.length);
                }
                
                // –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ
                if (allProjects.length === 0) {
                    console.log('–°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã');
                    allProjects = generateTestProjects();
                    localStorage.setItem('projects', JSON.stringify(allProjects));
                }
                
                console.log('–í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤:', allProjects.length);
                console.log('–ü—Ä–æ–µ–∫—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', allProjects.filter(p => p.manager === currentUser.full_name).length);
                
                displayUserProjects();
                displayActiveProjects();
            } catch (error) {
                console.error('Error loading profile:', error);
                showErrorPage();
            }

            feather.replace();
        });

        function generateTestProjects() {
            const projects = [];
            const users = [
                { id: 1, name: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" },
                { id: 2, name: "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞" },
                { id: 3, name: "–ê–ª–µ–∫—Å–µ–π –ö–æ–∑–ª–æ–≤" },
                { id: 5, name: "–î–º–∏—Ç—Ä–∏–π –ù–æ–≤–∏–∫–æ–≤" },
                { id: 19, name: "–°–µ—Ä–≥–µ–π –í–∞—Å–∏–ª—å–µ–≤" },
                { id: 23, name: "–ê–Ω–¥—Ä–µ–π –ü–∞–≤–ª–æ–≤" }
            ];

            const projectTemplates = [
                {
                    name: "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ CRM —Å–∏—Å—Ç–µ–º—ã",
                    organization: "–†–æ—Å–ù–µ—Ñ—Ç—å",
                    service: "cloud",
                    stage: "implementation",
                    status: "in_progress",
                    revenue: 2500000,
                    expenses: 800000,
                    priority: "high",
                    description: "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π CRM —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂"
                },
                {
                    name: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
                    organization: "–°–±–µ—Ä–±–∞–Ω–∫",
                    service: "consulting",
                    stage: "analysis",
                    status: "active",
                    revenue: 1800000,
                    expenses: 450000,
                    priority: "medium",
                    description: "–ö–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
                },
                {
                    name: "–ú–∏–≥—Ä–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–æ",
                    organization: "–ì–∞–∑–ø—Ä–æ–º",
                    service: "cloud",
                    stage: "negotiation",
                    status: "active",
                    revenue: 3200000,
                    expenses: 1200000,
                    priority: "critical",
                    description: "–ü–µ—Ä–µ–Ω–æ—Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ –æ–±–ª–∞—á–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É"
                },
                {
                    name: "–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
                    organization: "–í–¢–ë",
                    service: "security",
                    stage: "testing",
                    status: "in_progress",
                    revenue: 1500000,
                    expenses: 400000,
                    priority: "high",
                    description: "–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞—É–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
                },
                {
                    name: "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è IT-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
                    organization: "–õ—É–∫–æ–π–ª",
                    service: "network",
                    stage: "contract",
                    status: "active",
                    revenue: 2200000,
                    expenses: 700000,
                    priority: "medium",
                    description: "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–º–ø–∞–Ω–∏–∏"
                }
            ];

            users.forEach(user => {
                projectTemplates.forEach((template, index) => {
                    projects.push({
                        id: `user_${user.id}_project_${index + 1}`,
                        project_name: `${template.name} #${user.id}${index + 1}`,
                        organization: template.organization,
                        manager: user.name,
                        service: template.service,
                        stage: template.stage,
                        status: template.status,
                        revenue: template.revenue + (user.id * 100000),
                        expenses: template.expenses + (user.id * 50000),
                        priority: template.priority,
                        description: template.description,
                        created_at: new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000).toISOString(),
                        industry_solution: Math.random() > 0.5,
                        forecast: Math.random() > 0.3
                    });
                });
            });

            return projects;
        }

        function showErrorPage() {
            document.body.innerHTML = `
                <custom-navbar></custom-navbar>
                <div class="container mx-auto px-4 py-8 text-center">
                    <div class="bg-red-50 border border-red-200 rounded p-8">
                        <i data-feather="alert-triangle" class="w-12 h-12 text-red-600 mx-auto mb-4"></i>
                        <h3 class="text-red-800 font-medium text-lg">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω</h3>
                        <p class="text-red-600 mb-4">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è</p>
                        <button onclick="window.location.href = 'users.html'" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                        </button>
                    </div>
                </div>
            `;
            feather.replace();
        }

        function displayUserInfo(user) {
            document.getElementById('userName').textContent = user.full_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            document.getElementById('userRole').textContent = getRoleName(user.role);
            document.getElementById('userPosition').textContent = user.position || '–î–æ–ª–∂–Ω–æ—Å—Ç—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞';
            document.getElementById('userEmail').textContent = user.email || '–ù–µ —É–∫–∞–∑–∞–Ω';
            document.getElementById('userPhone').textContent = user.phone || '–ù–µ —É–∫–∞–∑–∞–Ω';
            document.getElementById('userCreatedAt').textContent = user.created_at ? new Date(user.created_at).toLocaleDateString('ru-RU') : '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            
            const statusElement = document.getElementById('userStatus');
            statusElement.innerHTML = `<span class="px-3 py-1 text-sm rounded-full ${user.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">${user.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</span>`;
        }

        function displayUserDetails(user) {
            const details = userDetails[user.id] || userDetails[4]; // fallback
            
            // –û–ø—ã—Ç –∏ —É—Ä–æ–≤–µ–Ω—å
            document.getElementById('userExperience').textContent = details.experience;
            document.getElementById('userLevel').textContent = details.level;
            
            // –ù–∞–≤—ã–∫–∏
            const skillsContainer = document.getElementById('userSkills');
            skillsContainer.innerHTML = details.skills.map(skill => `
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span>${skill.name}</span>
                        <span>${skill.level}%</span>
                    </div>
                    <div class="skill-bar">
                        <div class="skill-progress" style="width: ${skill.level}%"></div>
                    </div>
                </div>
            `).join('');
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            const achievementsElement = document.getElementById('userAchievements');
            achievementsElement.innerHTML = details.achievements.split('\n').map(line => 
                `<p class="flex items-start gap-2 mb-2"><span class="mt-1">${line.split(' ')[0]}</span><span>${line.split(' ').slice(1).join(' ')}</span></p>`
            ).join('');
            
            // –ö–∞—Ä—å–µ—Ä–∞
            const careerContainer = document.getElementById('userCareer');
            careerContainer.innerHTML = details.career.map(item => `
                <div class="timeline-item">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-purple-600">${item.position}</h4>
                            <span class="text-sm text-gray-500 bg-white px-2 py-1 rounded">${item.year}</span>
                        </div>
                        <p class="text-sm font-medium text-gray-700 mb-1">${item.company}</p>
                        <p class="text-sm text-gray-600">${item.description}</p>
                    </div>
                </div>
            `).join('');
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const statsContainer = document.getElementById('userStats');
            statsContainer.innerHTML = `
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <div class="text-2xl font-bold text-purple-600 mb-1">${details.stats.totalRevenue}</div>
                    <div class="text-sm text-gray-600">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div class="text-2xl font-bold text-green-600 mb-1">${details.stats.completedProjects}</div>
                    <div class="text-sm text-gray-600">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</div>
                </div>
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-2xl font-bold text-blue-600 mb-1">${details.stats.successRate}</div>
                    <div class="text-sm text-gray-600">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–æ–≤</div>
                </div>
            `;
        }

        function displayActiveProjects() {
            if (!currentUser) return;
            
            const container = document.getElementById('activeProjects');
            const countElement = document.getElementById('activeProjectsCount');
            
            // –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã - —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω—ã
            const activeProjects = allProjects.filter(p => {
                const isUserProject = p.manager === currentUser.full_name;
                const isActive = p.status !== 'completed' && p.status !== 'cancelled';
                console.log(`–ü—Ä–æ–µ–∫—Ç: ${p.project_name}, –ú–µ–Ω–µ–¥–∂–µ—Ä: ${p.manager}, –°—Ç–∞—Ç—É—Å: ${p.status}, –ê–∫—Ç–∏–≤–Ω—ã–π: ${isActive}`);
                return isUserProject && isActive;
            });
            
            console.log('–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', activeProjects.length);
            
            countElement.textContent = activeProjects.length;
            
            if (activeProjects.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i data-feather="clock" class="w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                        <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
                        <p class="text-sm mt-2">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã –∏–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –ø–∞—É–∑–µ</p>
                    </div>
                `;
                feather.replace();
                return;
            }
            
            let html = '';
            activeProjects.forEach(project => {
                const profit = Number(project.revenue || 0) - Number(project.expenses || 0);
                const progress = getStageProgress(project.stage);
                const daysInWork = Math.floor(Math.random() * 60) + 5; // 5-65 –¥–Ω–µ–π –≤ —Ä–∞–±–æ—Ç–µ
                
                html += `
                    <div class="project-card border-l-4 ${getStageBorderColor(project.stage)} p-4 bg-white rounded hover:shadow-lg transition-all duration-200">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h3 class="font-semibold text-lg mb-1">${project.project_name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                                <p class="text-sm text-gray-600 mb-2">${project.organization || '–ö–ª–∏–µ–Ω—Ç –Ω–µ —É–∫–∞–∑–∞–Ω'}</p>
                                <div class="flex flex-wrap gap-2 mb-2">
                                    <span class="stage-badge ${getStageBadgeClass(project.stage)}">
                                        ${getStageText(project.stage)}
                                    </span>
                                    <span class="stage-badge bg-gray-100 text-gray-700">
                                        ${daysInWork} –¥–Ω–µ–π –≤ —Ä–∞–±–æ—Ç–µ
                                    </span>
                                    <span class="stage-badge ${getStatusBadgeClass(project.status)}">
                                        ${getStatusText(project.status)}
                                    </span>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-lg font-bold text-purple-600">${formatCurrency(project.revenue || 0)}</div>
                                <div class="text-sm text-gray-500">–±—é–¥–∂–µ—Ç</div>
                            </div>
                        </div>
                        
                        <p class="text-sm text-gray-700 mb-3 line-clamp-2">${project.description || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ'}</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-3">
                            <div>
                                <span class="text-gray-500">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</span>
                                <div class="font-medium ${getPriorityClass(project.priority)}">${getPriorityText(project.priority)}</div>
                            </div>
                            <div>
                                <span class="text-gray-500">–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                                <div class="font-medium">${progress}%</div>
                            </div>
                            <div>
                                <span class="text-gray-500">–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:</span>
                                <div class="font-medium">${getNextStage(project.stage)}</div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <div class="flex-1">
                                <div class="skill-bar mb-1">
                                    <div class="skill-progress" style="width: ${progress}%"></div>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>–ù–∞—á–∞–ª–æ</span>
                                    <span>${progress}% –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
                                    <span>–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</span>
                                </div>
                            </div>
                            <div class="ml-4 text-right">
                                <div class="text-sm font-medium ${profit >= 0 ? 'text-green-600' : 'text-red-600'}">
                                    ${formatCurrency(profit)}
                                </div>
                                <div class="text-xs text-gray-500">–ø—Ä–∏–±—ã–ª—å</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            feather.replace();
        }

        function displayUserProjects() {
            if (!currentUser) return;
            
            const container = document.getElementById('userProjects');
            const totalCount = document.getElementById('totalProjectsCount');
            const userProjects = allProjects.filter(p => p.manager === currentUser.full_name);
            
            totalCount.textContent = userProjects.length;
            
            if (userProjects.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i data-feather="folder" class="w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                        <p>–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ–∫–∞ –Ω–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤</p>
                    </div>
                `;
                feather.replace();
                return;
            }
            
            let html = '';
            userProjects.forEach(project => {
                const profit = Number(project.revenue || 0) - Number(project.expenses || 0);
                const progress = Math.min(Math.floor((Math.random() * 40) + 60), 100); // 60-100%
                
                html += `
                    <div class="border-l-4 border-purple-600 p-4 bg-gray-50 rounded hover:bg-gray-100 transition">
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <h3 class="font-semibold text-lg">${project.project_name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                                <p class="text-sm text-gray-600">${project.organization || '–ö–ª–∏–µ–Ω—Ç –Ω–µ —É–∫–∞–∑–∞–Ω'}</p>
                            </div>
                            <div class="text-right">
                                <span class="text-sm px-2 py-1 rounded ${getStatusClass(project.status)}">${getStatusText(project.status)}</span>
                                <div class="text-sm text-gray-500 mt-1">${project.created_at ? new Date(project.created_at).toLocaleDateString('ru-RU') : ''}</div>
                            </div>
                        </div>
                        
                        <p class="text-sm text-gray-700 mb-3 line-clamp-2">${project.description || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ'}</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-sm mb-3">
                            <div>
                                <span class="text-gray-500">–í—ã—Ä—É—á–∫–∞:</span>
                                <div class="font-medium">${formatCurrency(project.revenue || 0)}</div>
                            </div>
                            <div>
                                <span class="text-gray-500">–ó–∞—Ç—Ä–∞—Ç—ã:</span>
                                <div class="font-medium">${formatCurrency(project.expenses || 0)}</div>
                            </div>
                            <div>
                                <span class="text-gray-500">–ü—Ä–∏–±—ã–ª—å:</span>
                                <div class="font-medium ${profit >= 0 ? 'text-green-600' : 'text-red-600'}">${formatCurrency(profit)}</div>
                            </div>
                            <div>
                                <span class="text-gray-500">–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                                <div class="font-medium">${progress}%</div>
                            </div>
                        </div>
                        
                        <div class="skill-bar mb-2">
                            <div class="skill-progress" style="width: ${progress}%"></div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            feather.replace();
        }

        function getRoleName(role) {
            const roles = {
                'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                'analyst': '–ê–Ω–∞–ª–∏—Ç–∏–∫',
                'user': '–ú–µ–Ω–µ–¥–∂–µ—Ä'
            };
            return roles[role] || role;
        }

        function getStageText(stage) {
            const map = {
                'new': '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç',
                'analysis': '–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π',
                'negotiation': '–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã', 
                'contract': '–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞',
                'implementation': '–†–µ–∞–ª–∏–∑–∞—Ü–∏—è',
                'testing': '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
                'completion': '–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ'
            };
            return map[stage] || stage;
        }

        function getStageProgress(stage) {
            const progressMap = {
                'new': 10,
                'analysis': 25,
                'negotiation': 40,
                'contract': 60,
                'implementation': 75,
                'testing': 90,
                'completion': 100
            };
            return progressMap[stage] || 0;
        }

        function getNextStage(currentStage) {
            const nextStages = {
                'new': '–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π',
                'analysis': '–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã',
                'negotiation': '–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞',
                'contract': '–†–µ–∞–ª–∏–∑–∞—Ü–∏—è',
                'implementation': '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
                'testing': '–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ',
                'completion': '–ü—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à–µ–Ω'
            };
            return nextStages[currentStage] || '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ';
        }

        function getStageBorderColor(stage) {
            const colors = {
                'new': 'border-blue-500',
                'analysis': 'border-purple-500',
                'negotiation': 'border-yellow-500',
                'contract': 'border-green-500',
                'implementation': 'border-indigo-500',
                'testing': 'border-orange-500',
                'completion': 'border-gray-500'
            };
            return colors[stage] || 'border-gray-400';
        }

        function getStageBadgeClass(stage) {
            const classes = {
                'new': 'bg-blue-100 text-blue-800',
                'analysis': 'bg-purple-100 text-purple-800',
                'negotiation': 'bg-yellow-100 text-yellow-800',
                'contract': 'bg-green-100 text-green-800',
                'implementation': 'bg-indigo-100 text-indigo-800',
                'testing': 'bg-orange-100 text-orange-800',
                'completion': 'bg-gray-100 text-gray-800'
            };
            return classes[stage] || 'bg-gray-100 text-gray-800';
        }

        function getStatusText(status) {
            const map = {
                'new': '–ù–æ–≤—ã–π',
                'active': '–ê–∫—Ç–∏–≤–µ–Ω',
                'in_progress': '–í —Ä–∞–±–æ—Ç–µ',
                'completed': '–ó–∞–≤–µ—Ä—à—ë–Ω',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
            };
            return map[status] || status;
        }

        function getStatusClass(status) {
            const map = {
                'new': 'bg-purple-100 text-purple-800',
                'active': 'bg-green-100 text-green-800',
                'in_progress': 'bg-yellow-100 text-yellow-800',
                'completed': 'bg-blue-100 text-blue-800',
                'cancelled': 'bg-red-100 text-red-800'
            };
            return map[status] || '';
        }

        function getStatusBadgeClass(status) {
            const map = {
                'new': 'bg-blue-100 text-blue-800',
                'active': 'bg-green-100 text-green-800',
                'in_progress': 'bg-yellow-100 text-yellow-800',
                'completed': 'bg-gray-100 text-gray-800',
                'cancelled': 'bg-red-100 text-red-800'
            };
            return map[status] || 'bg-gray-100 text-gray-800';
        }

        function getPriorityText(priority) {
            const map = {
                'low': '–ù–∏–∑–∫–∏–π',
                'medium': '–°—Ä–µ–¥–Ω–∏–π',
                'high': '–í—ã—Å–æ–∫–∏–π',
                'critical': '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π'
            };
            return map[priority] || '–ù–µ —É–∫–∞–∑–∞–Ω';
        }

        function getPriorityClass(priority) {
            const map = {
                'low': 'text-green-600',
                'medium': 'text-yellow-600',
                'high': 'text-orange-600',
                'critical': 'text-red-600'
            };
            return map[priority] || 'text-gray-600';
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('ru-RU', { 
                style: 'currency', 
                currency: 'RUB',
                minimumFractionDigits: 0 
            }).format(amount);
        }
    </script>
</body>
</html>